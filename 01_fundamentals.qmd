# R Fundamentals

This session will introduce the fundamental concepts, principles and tools that we will use during the course. Understanding these components provides the foundation for the rest of the course.

## Learning Objectives

By the end of today's session you should be able to:

1.  Be familiar with R, RStudio, Quarto and R programming.
2.  Handle different data types, including numeric, string and factors.
3.  Understand how to create and handle non-geographic and geographic data frames.
4.  Be familiar with common R packages, including the tidyverse and r-spatial ecosystems.

## Plan for the day

| Time          | Content                                 |
|---------------|-----------------------------------------|
| 10.00 - 10.15 | Introduction                            |
| 10.15 - 10.45 | Setting up & interacting with materials |
| 10.45 - 11.30 | R Basics                                |
| 11.30 - 11.50 | Break                                   |
| 11.50 - 12.50 | Using Quarto documents & Data types     |
| 12.50 - 13.30 | Lunch                                   |
| 13.30 - 14.15 | Non-geographic data frames              |
| 14.15 - 14.45 | Geographic data frames                  |

## Dependencies

```{r}
#| warning: false
#| message: false

# data manipulation
library(tidyverse)
# spatial data manipulation
library(sf)
```

## Introducing R

R is a freely available language and environment for statistical computing and graphics which provides a wide variety of statistical and graphical techniques. It has gained widespread use in academia and industry. R offers a wider array of functionality than a traditional statistics package, is composed of core (base) functionality, and is expandable through libraries hosted on (The Comprehensive R Archive Network (CRAN))\[https://cran.r-project.org\]. CRAN is a network of ftp and web servers around the world that store identical, up-to-date, versions of code and documentation for R.

Commands are sent to R using either the terminal / command line or the R Console which is installed with R on either Windows or OS X. On Linux, there is no equivalent of the console, however, third party solutions exist. On your own machine, R can be installed from here.

Normally RStudio is used to implement R coding. RStudio is an integrated development environment (IDE) for R and provides a more user-friendly front-end to R than the front-end provided with R.

To run R or RStudio, just double click on the R or RStudio icon. Throughout this course, we will be using RStudio:

![](./figs/01/rstudio-shot.png)

::: column-margin
::: callout-note
If you would like to know more about the various features of RStudio, watch this video.
:::
:::

## Working directory

Before we start any analysis, ensure to set the path to the directory where we are working. We have two options to do this.

**Option 1**

Once you have opened R, you can use the command `setwd( )` to set the working directory. For example, replace in the following line the path to the folder where you have placed this file and where the data folder lives.

```{r}
#| eval: false
setwd("")
```

You can check your current working directory by typing:

```{r}
#| eval: false
getwd()
```

**Option 2**

Before opening any files in the folder, open the file with the extension `*.Rproj`. This is a R project and automatically indexes all the files in the folder and subfolders so there is no need to explicitly set the working directory. You can call any files in the R project folder by replacing the working directory with "`.`". For instance, let us open a dataset from our subfolder data:

```{r}
#| eval: false
read_csv("./data")
```

## R scripts and Quarto documents

### R script

An *R script* is a series of commands that you can execute at one time and help you save time. R scripts are useful to ensure reproducibility; that is if you want to repeat the same series of steps with the same or different datasets. An R script is a plain text file with R commands.

::: column-margin
::: callout-note
To get familiar with good practices in writing your code in R, we recommend the Chapter Workflow: basics and Workflow: scripts and projects from the R in Data Science book by [Wickham, Çetinkaya-Rundel, and Grolemund (2023)](https://r4ds.hadley.nz/workflow-basics.html)
:::
:::

To create an R script in RStudio, you need to:

-   Open a new script file: File \> New File \> R Script

-   Write some code on your new script window by typing eg. mtcars

-   Run the script. Click anywhere on the line of code, then hit Ctrl + Enter (Windows) or Cmd + Enter (Mac) to run the command or select the code chunk and click run on the right-top corner of your script window. If do that, you should get:

```{r}
mtcars
```

-   Save the script: *File* \> *Save As*, select your required destination folder, and enter any filename that you like, provided that it ends with the file extension *.R*

::: {.callout-tip appearance="simple" icon="false"}
**Task**

Open and create a basic R Script
:::

### Quarto Document

A *Quarto Document* is based on Markdown technology. It allows to integrate descriptive text and code chunks. Code chunks can be executed independently and interactively, with output visible immediately beneath a code chunk - see @xie2018. A Quarto Document is an improved version of the original R Notebook. Quarto Document requires a package called Quarto. Quarto does not have a dependency or requirement for R. Quarto is multilingual, beginning with R, Python, Javascript, and Julia. The concept is that Quarto will work even for languages that do not yet exist.

To create a Quarto Document, you need to:

-   Open a new script file: File \> New File \> Quarto Document.

-   Quarto Documents work in the same way as R Notebooks with small variations. You can find a comprehensive guide on how to use Quarto Documents on the Quarto website.

::: {.callout-tip appearance="simple" icon="false"}
**Task**

Open, create, preview and render a Quarto Document
:::

Now that you are familiar with Quarto, we will explore some basic elements:

-   YAML options

-   Code chunks

-   Preview

-   Rendering

To master Quarto, please read the [Quarto Guide page](https://quarto.org/docs/guide/).

### Using quarto documents

Quarto documents are very flexible. They can be rendered into different formats, including pdf, html and doc files. They can be used to product reports, articles, briefs, websites, books and more. We can explore how this can be done using some of the templates we have produced and are hosted on our personal [Github](https://github.com/fcorowe/research-article-template) repository.

Let us explore the use of Quarto documents by downloading the repository above and examine the various templates available.

::: {.callout-tip appearance="simple" icon="false"}
**Task**

Include your name and affiliation on one of the Quarto Document templates. Also try changing the font family.
:::

## Help

You can use `help` or `?` to ask for details for a specific function:

```         
help(sqrt) #or ?sqrt
```

And using `example` provides examples for said function:

```{r}
#| warning: false
#| message: false
example(geom_map)
```

::: {.callout-tip appearance="simple" icon="false"}
**Task**

Ask for help for a different function.
:::


## R data types

There are a number of data types. Four are the most common. In R, numeric is the default type for numbers. It stores all numbers as floating-point numbers (numbers with decimals). This is because most statistical calculations deal with numbers with up to two decimals.

Numeric
```{r}
num <- 4.5 # Decimal values
class(num)
```

Integer
```{r}
int <- as.integer(4) # Natural numbers. Note integers are also numerics.
class(int)
```

Character
```{r}
cha <- "are you enjoying this?" # text or string. You can also type `as.character("are you enjoying this?")`
class(cha)
```

Logical
```{r}
log <- 2 < 1 # assigns TRUE or FALSE. In this case, FALSE as 2 is greater than 1
log
class(log)
```

You can create vectors by concatenating elements:
```{r}
data_vector <- c(2, 3, 4, 5, 6)
data_vector
```


::: {.callout-tip appearance="simple" icon="false"}
**Task**

Create a variable called income, with the following five respondent values: high, low, low, middle, high.
:::


### Factors

A factor variable assigns a numeric code to each possible category (level) in a variable. Behind the scenes, R stores the variable using these numeric codes to save space and speed up computing. For example, compare the size of a list of 10,000 males and females to a list of 10,000 1s and 0s. At the same time R also saves the category names associated with each numeric code (level). These are used for display purposes.

For example, the variable gender, converted to a factor, would be stored as a series of 1s and 2s, where 1 = female and 2 = male; but would be displayed in all outputs using their category labels of female and male.

**Defining a factor**

A factor can be defined by first creating a numeric or character vector; for example:

```{r}
gender <- c("female", "male", "male", "female", "female") # create a gender variable
gender <- factor(gender) # replace character vector with a factor version
gender
```


## Data frames

### Non-geographic data frames

**Reading data frames**

**Creating data frames**

**Referencing data frames**

**Manipulating data frames**

`tidyverse`

### Geographic data frames

**Reading geographic data frames**

**Manipulating geographic data frames**
